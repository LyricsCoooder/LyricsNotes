# 过度拟合与模型选择

如果在假设空间中存在解决问题的“真”模型，那么统计学习选择的模型应该更接近，具体的所选择的模型应该和“真”模型的参数个数相同，所选择的模型的参数与 “真” 模型的参数向量相近，如果一味追求并提高对训练数据的预测能力，所选模型的复杂度往往会比真模型的复杂度更高，导致对训练数据集的预测能力很好，但对未知数据集的预测能力很差.

#### 用多项式来逼近正弦函数的例子

假设“真”模型函数为：
$$
t = \sin(2\pi x) + n
$$
其中 $n$ 是噪声，假设我们有关于这个模型的 $N$ 次观测，也就是说我们有长为 $N$ 的 $\mathbf{x} = (x_{1},\ldots ,x_{N})^{T}$ 输入观测值，以及其对应的输出观测值$\mathbf{t} = (t_{1},\ldots ,t_{N})^{T}$ ,在下图中给出了这个模型的十次观测结果和真实的正弦曲线.

<img src="D:/MyNote/.%E5%9B%BE%E7%89%87/%E8%BF%87%E6%8B%9F%E5%90%881.PNG" alt="shadow-zoom" style="zoom: 67%;" />

我们认为这个潜在的模型存在于 $(1,x,\ldots ,x^{M})$ 张成的空间，$M+1$ 是这个多项式空间的维度，所以多项式拟合的结果可以表示为：
$$
y(x, \mathbf{w}) = w_{0} + w_{1}x + \ldots + w_{M}x^{M} = \sum_{j=0}^{M}w_{j}x^{j}
$$
这个多项式的系数 $w_{j},j\in \{0,\ldots ,M\}$ 就是我们要学习的目标，通过风险最小化策略，这里使用平方损失函数 $(y(x_{n}, \mathbf{w}) - t_{n})^{2}$ ,即：
$$
L( \mathbf{w}) = \frac{1}{2} \sum_{n=1}^{N}(y(x_{n}, \mathbf{w}) - t_{n})^{2}
$$
然后对 $L(\mathbf{w})$ 对每一个 $w_{j},j\in \{0,\ldots ,M\}$ 求导数，这里的 $\frac{1}{2}$ 便是用来方便导数的计算，就可以得出 $w_j$，在这里由于误差函数是二次的，其导数就是一次的，所以每个 $w_{j}$ 是唯一的，所以可以找出 $y(x,\mathbf w)$ 的最优拟合，记作 $y(x,\mathbf w')$ .

下表展示了不同 $M$ 对应的 $w'$ 取值：

|          | $M=0$  | $M=1$ | $M=6$  |    $M=9$    |
| :------: | :----: | :---: | :----: | :---------: |
| $w'_{0}$ | 0.1970 | 0.82  |  0.31  |    0.35     |
| $w'_{1}$ |        | -1.27 |  7.99  |   232.37    |
| $w'_{2}$ |        |       | -25.43 |  -5321.83   |
| $w'_{3}$ |        |       | 17.37  |  48568.31   |
| $w'_{4}$ |        |       |        | -231639.30  |
| $w'_{5}$ |        |       |        |  640042.26  |
| $w'_{6}$ |        |       |        | -1061800.52 |
| $w'_{7}$ |        |       |        | 1042400.18  |
| $w'_{8}$ |        |       |        | -557682.99  |
| $w'_{9}$ |        |       |        |  125201.43  |

这时，还需要选择合适 $M$ 值，选 $M$ 的过程在机器学习领域叫做模型选择，下图给出了当 $M$ 取不同值时，模型对 $y(x,\mathbf w)$ 的拟合结果.

<img src="D:/MyNote/.%E5%9B%BE%E7%89%87/%E8%BF%87%E6%8B%9F%E5%90%882.PNG" alt="过拟合2" style="zoom:50%;" />

当 $M = 0$ 时对 $\sin(2\pi x)$ 的拟合是非常粗糙的，当 $M = 3$ 时对 $\sin(2\pi x)$ 给出了最好的拟合，而当 $M=9$ 时多项式通过了每个数据点，训练误差是最低的，但是与 $\sin(2\pi x)$ 相差甚远，这种现象被称为**过度拟合**，造成随着模型负责度增加，训练误差与测试误差越来越大的现象.
